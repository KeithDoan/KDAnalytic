{"name":"mortgagee.csv_flow","pipeline":{"version":"1.0","doc_type":"pipeline","app_data":{"shaperCreated":true,"replace_space_by_dot":true},"primary_pipeline":"pipeline1","pipelines":[{"id":"pipeline1","runtime":"Spark","nodes":[{"id":"source1","data_asset":{"app_data":{"project_name":"KDAnalytics","dataset_name":"mortgagee.csv"}},"type":"binding","output":{"id":"source1output"}},{"id":"c5855998-9656-4fdc-be83-9709025a66b0","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"replaceSubstringOp","code":"mutate(`HouseholdIncome` = stringr::str_replace_all(`HouseholdIncome`, stringr::regex(\"[\\\\\\\\$\\\\\\\\.]\"), \"\"))","args":{"column":"HouseholdIncome","replaceOption":"pattern","in_value":"[\\\\\\\\$\\\\\\\\.]","out_value":"","replaceAllFlag":true,"newColumnName":""}}},"parameters":{"FREEFORM_CODE":"spark_apply(function(df) dplyr::mutate(df, `HouseholdIncome` = stringr::str_replace_all(`HouseholdIncome`, stringr::regex(\"[\\\\\\\\$\\\\\\\\.]\"), \"\")), memory=FALSE, names = c('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','HouseholdIncome','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount'))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"source1","port_id_ref":"source1output"}]}],"outputs":[{"id":"outputPort1"}]},{"id":"b17b3efe-5ac0-414b-932c-3ec0eecb9d83","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`HouseholdIncome` = as.integer(`HouseholdIncome`))","args":{"column":"HouseholdIncome","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`HouseholdIncome` = as.integer(`HouseholdIncome`))%>%select('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','HouseholdIncome','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"c5855998-9656-4fdc-be83-9709025a66b0","port_id_ref":"outputPort1"}]}],"outputs":[{"id":"outputPort2"}]},{"id":"603c73fe-e30f-47a1-8719-97fef5f5952b","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"rename","code":"rename(`Income` = `HouseholdIncome`)","args":{"column":"HouseholdIncome","newColumnName":"Income"}}},"parameters":{"FREEFORM_CODE":"rename(`Income` = `HouseholdIncome`)"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"b17b3efe-5ac0-414b-932c-3ec0eecb9d83","port_id_ref":"outputPort2"}]}],"outputs":[{"id":"outputPort3"}]},{"id":"317cbf51-cfdb-449f-9266-d57d538a22f8","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`SalePrice` = as.integer(`SalePrice`))","args":{"column":"SalePrice","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`SalePrice` = as.integer(`SalePrice`))%>%select('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','Income','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"603c73fe-e30f-47a1-8719-97fef5f5952b","port_id_ref":"outputPort3"}]}],"outputs":[{"id":"outputPort4"}]},{"id":"c2635aef-5ee9-4226-b164-306245f587b3","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`Location` = as.integer(`Location`))","args":{"column":"Location","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`Location` = as.integer(`Location`))%>%select('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','Income','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"317cbf51-cfdb-449f-9266-d57d538a22f8","port_id_ref":"outputPort4"}]}],"outputs":[{"id":"outputPort5"}]},{"id":"16099d8d-6a38-4b8d-bc1c-9719bfba7045","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`Age` = as.integer(`Age`))","args":{"column":"Age","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`Age` = as.integer(`Age`))%>%select('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','Income','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"c2635aef-5ee9-4226-b164-306245f587b3","port_id_ref":"outputPort5"}]}],"outputs":[{"id":"outputPort6"}]},{"id":"2f9f37bc-1cac-4034-9a16-c4f815a9a6bd","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`EducationLevel` = as.integer(`EducationLevel`))","args":{"column":"EducationLevel","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`EducationLevel` = as.integer(`EducationLevel`))%>%select('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','Income','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"16099d8d-6a38-4b8d-bc1c-9719bfba7045","port_id_ref":"outputPort6"}]}],"outputs":[{"id":"outputPort7"}]},{"id":"812b6ac8-0a7a-41dc-8714-c88e4f3059af","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`YearsWithCurrentEmployer` = as.integer(`YearsWithCurrentEmployer`))","args":{"column":"YearsWithCurrentEmployer","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`YearsWithCurrentEmployer` = as.integer(`YearsWithCurrentEmployer`))%>%select('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','Income','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"2f9f37bc-1cac-4034-9a16-c4f815a9a6bd","port_id_ref":"outputPort7"}]}],"outputs":[{"id":"outputPort8"}]},{"id":"10fafc52-a2cc-4ac3-bdef-536d38a4a3ec","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`YearsAtCurrentAddress` = as.integer(`YearsAtCurrentAddress`))","args":{"column":"YearsAtCurrentAddress","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`YearsAtCurrentAddress` = as.integer(`YearsAtCurrentAddress`))%>%select('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','Income','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"812b6ac8-0a7a-41dc-8714-c88e4f3059af","port_id_ref":"outputPort8"}]}],"outputs":[{"id":"outputPort9"}]},{"id":"95a19cff-a39b-4fd6-b9cc-26cf721a0f36","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`LoanAmount` = as.double(`LoanAmount`))","args":{"column":"LoanAmount","type":"as.double","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`LoanAmount` = as.double(`LoanAmount`))%>%select('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','Income','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"10fafc52-a2cc-4ac3-bdef-536d38a4a3ec","port_id_ref":"outputPort9"}]}],"outputs":[{"id":"outputPort10"}]},{"id":"81c88319-7c26-424e-ada1-0fd689c8560f","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`DebtIncomeRatio` = as.double(`DebtIncomeRatio`))","args":{"column":"DebtIncomeRatio","type":"as.double","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`DebtIncomeRatio` = as.double(`DebtIncomeRatio`))%>%select('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','Income','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"95a19cff-a39b-4fd6-b9cc-26cf721a0f36","port_id_ref":"outputPort10"}]}],"outputs":[{"id":"outputPort11"}]},{"id":"b09ac118-7d77-49b1-bd30-232dc7141bc0","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`CreditCardDebt` = as.double(`CreditCardDebt`))","args":{"column":"CreditCardDebt","type":"as.double","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`CreditCardDebt` = as.double(`CreditCardDebt`))%>%select('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','Income','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"81c88319-7c26-424e-ada1-0fd689c8560f","port_id_ref":"outputPort11"}]}],"outputs":[{"id":"outputPort12"}]},{"id":"39804606-ebfa-4355-916f-dd50a616b121","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`OtherDebt` = as.double(`OtherDebt`))","args":{"column":"OtherDebt","type":"as.double","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`OtherDebt` = as.double(`OtherDebt`))%>%select('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','Income','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"b09ac118-7d77-49b1-bd30-232dc7141bc0","port_id_ref":"outputPort12"}]}],"outputs":[{"id":"outputPort13"}]},{"id":"bcb5ba24-848b-483a-a0d2-655a546aacca","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`NumberOfCards` = as.integer(`NumberOfCards`))","args":{"column":"NumberOfCards","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`NumberOfCards` = as.integer(`NumberOfCards`))%>%select('ID','PreviouslyDefaulted','City','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','Income','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"39804606-ebfa-4355-916f-dd50a616b121","port_id_ref":"outputPort13"}]}],"outputs":[{"id":"outputPort14"}]},{"id":"a241f978-5bd7-45b1-8e7c-673d31547fd2","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"splitColumn","code":"tidyr::separate(`City`, into = c('State','CityArea'), remove = TRUE, extra = 'merge', fill = 'right')","args":{"column":"City","type":"default","value":"","removeAllColumns":true,"extra":"merge","fill":"right","newColumnNames":"State,CityArea"}}},"parameters":{"FREEFORM_CODE":"spark_apply(function(df) tidyr::separate(df, `City`, into = c('State','CityArea'), remove = TRUE, extra = 'merge', fill = 'right'), memory=FALSE, names = c('ID','PreviouslyDefaulted','State','CityArea','SalePrice','Location','Age','EducationLevel','YearsWithCurrentEmployer','YearsAtCurrentAddress','Income','DebtIncomeRatio','CreditCardDebt','OtherDebt','Residence','NumberOfCards','LoanAmount'))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"bcb5ba24-848b-483a-a0d2-655a546aacca","port_id_ref":"outputPort14"}]}],"outputs":[{"id":"outputPort15"}]},{"id":"target1","type":"binding","input":{"id":"targetInput1","link":{"node_id_ref":"a241f978-5bd7-45b1-8e7c-673d31547fd2","port_id_ref":"outputPort15"}}}]}]}}