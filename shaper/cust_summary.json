{"name":"cust_summary.csv_flow","pipeline":{"version":"1.0","doc_type":"pipeline","app_data":{"shaperCreated":true,"replace_space_by_dot":true},"primary_pipeline":"pipeline1","pipelines":[{"id":"pipeline1","runtime":"Spark","nodes":[{"id":"source1","data_asset":{"app_data":{"project_name":"KDAnalytics","dataset_name":"cust_summary.csv"}},"type":"binding","output":{"id":"source1output"}},{"id":"03531094-1891-4229-afc4-c1a5a0e4a940","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mask","code":"mutate(`CUST_ID`=digest::digest(`CUST_ID`, seed=2, algo=\"md5\"))","args":{"column":"CUST_ID","type":"substitute","seed":2,"algo":"md5"}}},"parameters":{"FREEFORM_CODE":"spark_apply(function(df) dplyr::mutate(df, `CUST_ID` = digest::digest(`CUST_ID`, seed=2, algo=\"md5\")), memory=FALSE, names = c('CUST_ID','BIRTH_DATE','GENDER','AGE','INVESTMENT','INCOME','ACTIVITY',' YRLY_AMT','AVG_DAILY_TX','YRLY_TX','AVG_TX_AMT','NEGTWEETS','STATE','EDUCATION','label'))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"source1","port_id_ref":"source1output"}]}],"outputs":[{"id":"outputPort1"}]},{"id":"9f5f4a38-f9a2-46c8-81c5-b31a0f012f2a","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"drop","code":"select(-`BIRTH_DATE`)","args":{"column":"BIRTH_DATE"}}},"parameters":{"FREEFORM_CODE":"select(-`BIRTH_DATE`)"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"03531094-1891-4229-afc4-c1a5a0e4a940","port_id_ref":"outputPort1"}]}],"outputs":[{"id":"outputPort2"}]},{"id":"e4775d2e-fa64-42de-b50b-59817a4ea833","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`INVESTMENT` = as.integer(`INVESTMENT`))","args":{"column":"INVESTMENT","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`INVESTMENT` = as.integer(`INVESTMENT`))%>%select('CUST_ID','GENDER','AGE','INVESTMENT','INCOME','ACTIVITY',' YRLY_AMT','AVG_DAILY_TX','YRLY_TX','AVG_TX_AMT','NEGTWEETS','STATE','EDUCATION','label')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"9f5f4a38-f9a2-46c8-81c5-b31a0f012f2a","port_id_ref":"outputPort2"}]}],"outputs":[{"id":"outputPort3"}]},{"id":"88053262-61be-4523-b34b-0f7fcba555c1","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`AGE` = as.integer(`AGE`))","args":{"column":"AGE","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`AGE` = as.integer(`AGE`))%>%select('CUST_ID','GENDER','AGE','INVESTMENT','INCOME','ACTIVITY',' YRLY_AMT','AVG_DAILY_TX','YRLY_TX','AVG_TX_AMT','NEGTWEETS','STATE','EDUCATION','label')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"e4775d2e-fa64-42de-b50b-59817a4ea833","port_id_ref":"outputPort3"}]}],"outputs":[{"id":"outputPort4"}]},{"id":"c248146a-a1a4-40e4-9e50-1a10a20b9c18","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`ACTIVITY` = as.integer(`ACTIVITY`))","args":{"column":"ACTIVITY","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`ACTIVITY` = as.integer(`ACTIVITY`))%>%select('CUST_ID','GENDER','AGE','INVESTMENT','INCOME','ACTIVITY',' YRLY_AMT','AVG_DAILY_TX','YRLY_TX','AVG_TX_AMT','NEGTWEETS','STATE','EDUCATION','label')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"88053262-61be-4523-b34b-0f7fcba555c1","port_id_ref":"outputPort4"}]}],"outputs":[{"id":"outputPort5"}]},{"id":"4f7cc053-a3f7-419b-9ce2-0dfe648d3e2a","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(` YRLY_AMT` = as.double(` YRLY_AMT`))","args":{"column":" YRLY_AMT","type":"as.double","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(` YRLY_AMT` = as.double(` YRLY_AMT`))%>%select('CUST_ID','GENDER','AGE','INVESTMENT','INCOME','ACTIVITY',' YRLY_AMT','AVG_DAILY_TX','YRLY_TX','AVG_TX_AMT','NEGTWEETS','STATE','EDUCATION','label')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"c248146a-a1a4-40e4-9e50-1a10a20b9c18","port_id_ref":"outputPort5"}]}],"outputs":[{"id":"outputPort6"}]},{"id":"60937448-8f1a-4057-9bda-b0fe97dd466c","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`AVG_DAILY_TX` = as.double(`AVG_DAILY_TX`))","args":{"column":"AVG_DAILY_TX","type":"as.double","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`AVG_DAILY_TX` = as.double(`AVG_DAILY_TX`))%>%select('CUST_ID','GENDER','AGE','INVESTMENT','INCOME','ACTIVITY',' YRLY_AMT','AVG_DAILY_TX','YRLY_TX','AVG_TX_AMT','NEGTWEETS','STATE','EDUCATION','label')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"4f7cc053-a3f7-419b-9ce2-0dfe648d3e2a","port_id_ref":"outputPort6"}]}],"outputs":[{"id":"outputPort7"}]},{"id":"e8421ad9-0997-44d0-8be8-deea4237e6ac","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`YRLY_TX` = as.integer(`YRLY_TX`))","args":{"column":"YRLY_TX","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`YRLY_TX` = as.integer(`YRLY_TX`))%>%select('CUST_ID','GENDER','AGE','INVESTMENT','INCOME','ACTIVITY',' YRLY_AMT','AVG_DAILY_TX','YRLY_TX','AVG_TX_AMT','NEGTWEETS','STATE','EDUCATION','label')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"60937448-8f1a-4057-9bda-b0fe97dd466c","port_id_ref":"outputPort7"}]}],"outputs":[{"id":"outputPort8"}]},{"id":"20b0a062-a4f8-4bd9-a1b0-289338464eac","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`AVG_TX_AMT` = as.double(`AVG_TX_AMT`))","args":{"column":"AVG_TX_AMT","type":"as.double","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`AVG_TX_AMT` = as.double(`AVG_TX_AMT`))%>%select('CUST_ID','GENDER','AGE','INVESTMENT','INCOME','ACTIVITY',' YRLY_AMT','AVG_DAILY_TX','YRLY_TX','AVG_TX_AMT','NEGTWEETS','STATE','EDUCATION','label')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"e8421ad9-0997-44d0-8be8-deea4237e6ac","port_id_ref":"outputPort8"}]}],"outputs":[{"id":"outputPort9"}]},{"id":"8157a6b8-1172-4c7b-8e36-2ea7bc5c9377","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`NEGTWEETS` = as.integer(`NEGTWEETS`))","args":{"column":"NEGTWEETS","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`NEGTWEETS` = as.integer(`NEGTWEETS`))%>%select('CUST_ID','GENDER','AGE','INVESTMENT','INCOME','ACTIVITY',' YRLY_AMT','AVG_DAILY_TX','YRLY_TX','AVG_TX_AMT','NEGTWEETS','STATE','EDUCATION','label')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"20b0a062-a4f8-4bd9-a1b0-289338464eac","port_id_ref":"outputPort9"}]}],"outputs":[{"id":"outputPort10"}]},{"id":"4acc9eaa-4bd8-4946-964f-9c9a1e59a527","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`label` = as.integer(`label`))","args":{"column":"label","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`label` = as.integer(`label`))%>%select('CUST_ID','GENDER','AGE','INVESTMENT','INCOME','ACTIVITY',' YRLY_AMT','AVG_DAILY_TX','YRLY_TX','AVG_TX_AMT','NEGTWEETS','STATE','EDUCATION','label')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"8157a6b8-1172-4c7b-8e36-2ea7bc5c9377","port_id_ref":"outputPort10"}]}],"outputs":[{"id":"outputPort11"}]},{"id":"e441b6b5-966b-4fce-94b5-3366f084a025","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`INCOME` = as.integer(`INCOME`))","args":{"column":"INCOME","type":"as.integer","actualType":"String","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`INCOME` = as.integer(`INCOME`))%>%select('CUST_ID','GENDER','AGE','INVESTMENT','INCOME','ACTIVITY',' YRLY_AMT','AVG_DAILY_TX','YRLY_TX','AVG_TX_AMT','NEGTWEETS','STATE','EDUCATION','label')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"4acc9eaa-4bd8-4946-964f-9c9a1e59a527","port_id_ref":"outputPort11"}]}],"outputs":[{"id":"outputPort12"}]},{"id":"f6b57a7a-3e55-4abe-88e3-49f8179ec1a1","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"calculateNewColumn","code":"mutate(`AGE_GROUP` = `AGE`/20)","args":{"column":"AGE","operator":"/","option":"value","value":"20","newColumnName":"AGE_GROUP"}}},"parameters":{"FREEFORM_CODE":"mutate(`AGE_GROUP` = `AGE`/20)"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"e441b6b5-966b-4fce-94b5-3366f084a025","port_id_ref":"outputPort12"}]}],"outputs":[{"id":"outputPort13"}]},{"id":"0ce92b22-f507-4575-b3a6-e668ed5eb022","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`AGE_GROUP` = as.integer(`AGE_GROUP`))","args":{"column":"AGE_GROUP","type":"as.integer","actualType":"Decimal","newColumnName":""}}},"parameters":{"FREEFORM_CODE":"mutate(`AGE_GROUP` = as.integer(`AGE_GROUP`))%>%select('CUST_ID','GENDER','AGE','INVESTMENT','INCOME','ACTIVITY',' YRLY_AMT','AVG_DAILY_TX','YRLY_TX','AVG_TX_AMT','NEGTWEETS','STATE','EDUCATION','label','AGE_GROUP')"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"f6b57a7a-3e55-4abe-88e3-49f8179ec1a1","port_id_ref":"outputPort13"}]}],"outputs":[{"id":"outputPort14"}]},{"id":"target1","type":"binding","data_asset":{"properties":{"name":"cust_summary.csv_shaped.csv","mode":"overwrite"},"app_data":{}},"input":{"id":"targetInput1","link":{"node_id_ref":"0ce92b22-f507-4575-b3a6-e668ed5eb022","port_id_ref":"outputPort14"}}}]}]}}